#include <bits/stdc++.h>
using namespace std;
#define ll long long
#define mset(x,v) memset(x, v, sizeof(x))
#define pb push_back
#define dbg(x) cout<<#x<<" "<<x<<endl;
#define inf (ll)1e18
#define mag 10000000

ll dp[1000000];
ll store[1000000];
int main()
{
    ll nodes,edges;cin>>nodes>>edges;
    map<ll,vector<pair<ll,ll> > >mp;

    while(edges--){
        ll x,y,wt;cin>>x>>y>>wt;
        mp[wt].pb({x,y});
    }
    for(auto it:mp){
        for(auto itv:it.second){
            store[itv.second]=max(dp[itv.second],dp[itv.first]+1);
        }
        for(auto itv:it.second)
            dp[itv.second]=store[itv.second];
    }
    ll ans=0;
    for(ll i=1;i<=nodes;i++)
        ans=max(ans,dp[i]);
    cout<<ans;
}
